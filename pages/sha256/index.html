<!DOCTYPE html>
<html>

<head>
  <title>SHA256 online</title>
  <link rel="stylesheet" type="text/css" href="../css/sweetalert2.min.css">
  <script src="../js/sweetalert2.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <link rel="stylesheet" href="../../css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="../../css/cayman.css">
  <style type="text/css">
    #target {
      width: 600px;
      max-width: 100%;
      height: 300px;
      border: 1px solid black;
    }
  </style>
  <!-- script src="../js/eruda.js"></script>
  <script>
    eruda.init();
  </script -->
  <!-- script src="test.js"></script -->
  <!-- script>var sha256_ = sha256;</script -->
  <script src="sha256build.js"></script>
</head>

<body>
  <section class="page-header">
    <h1 class="project-name">Contents List</h1>
    <a href="../../index.html" class="btn">Main Menu</a>
  </section>

  <section class="main-content">
    <br />
    <h1> SHA - 256 online (works offline) </h1>
    <h2> For text: </h2>
    <textarea id="target" width="600" height="300" autofocus="true"></textarea>
    <br />
    <input type="button" id="fire" value="Get hash" onclick="hash256()">
    <br />
    <hr />
    <h2> For files: </h2>
    <input type="file" id="files">
    <br />
    <br />
    <br />
    <input type="button" id="fire" value="Get hash of the file" onclick="hash256file()">
    <br />
    <p id="output" style="white-space: pre-line;"></p>
    <footer class="site-footer">
      <span class="site-footer-owner">Miles Jamon (c) 2019 - <span id="yearToday"></span></span>
        <script>document.getElementById("yearToday").innerText = (new Date()).getFullYear();</script>
      <span class="site-footer-credits">This uses the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a></span>
      <span class="site-footer-credits">and this page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
    </footer>

  </section>
  <script>
    function hash256() {
      var message = document.getElementById('target').value;
      var hash = sha256(message, true);
      Swal.fire({
        type: "success",
        title: "SHA-256 hash",
        html: "message: '" + message + "', hash: " + hash + "\n"
      });
    }

    function _hash256file() {
      var file = document.getElementById('files').files[0];
      var message = getBase64File(file);
      var hash = sha256(message);
      Swal.fire({
        type: "success",
        title: "SHA-256 hash",
        html: "hash: " + hash + "\n"
      });
    }

    function hash256file() {
      var file = document.getElementById('files').files[0];
      if(typeof file === "undefined") {
        Swal.fire({
          type: "error",
          title: "SHA-256 hash",
          html: "Please choose a valid file"
        });
        return;
      }
      var reader = new FileReader();
      Swal.fire({
        type: "info",
        title: "SHA-256 hash",
        html: "Please wait while the file is being hashed...",
        showConfirmButton: false
      });
      reader.onload = function(event) {
        //var message = reader.result;
        var message = event.target.result;
        setTimeout(function() {
          var output = sha256(message);
          Swal.fire({
            type: "success",
            title: "SHA-256 hash",
            html: "hash: " + output + "\n"
          });
        }, 1000);
      };
      reader.onerror = function(err) {
        Swal.fire({
          type: "error",
          title: "SHA-256 hash",
          message: err
        });
      };
      reader.readAsBinaryString(file);
    }
  </script>
</body>

</html>